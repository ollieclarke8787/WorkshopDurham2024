needsPackage "Matroids"
load "MLDegrees.m2"

basisMatrix = method()
basisMatrix Matroid := M -> (
    n := # groundSet M;
    B := bases M;
    matrix for i from 0 to n-1 list for b in B list if member(i, b) then 1 else 0
    )





end --

load "matroids.m2"

M = matroid matrix {
    {1,1,1,1},
    {1,2,3,4}
    }
bases M
A = basisMatrix M
T = twistedToricIdeal(A, {1,1,1,4,1,1})
degree T
ADeterminant A
ADeterminant(A, Strategy => "Saturation")

toricMLDegree(A, {1,1,1,4,1,1})
toricMLDegree(A, {1,1,2,2,1,1})
toricMLDegree(A, {1,3,4,4,3,1})
toricMLDegree(A, {1,1,4,4,9,1})
toricMLDegree(A, {1,1,1,16,9,1})
toricMLDegree(A, {1,3,1,16,3,1})
toricMLDegree(A, {1,1,1,49,36,1})



P = convexHull A
V = vertices P
faces P

I = MLImpIdeal(A, {1,1,1,4,1,1}, {1,2,3,4,5,6})
netList solveSystem first entries mingens I

M = matroid matrix {
    {1,1,1,1,1},
    {1,2,3,4,5}
    }
A = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
ADeterminant A


M = uniformMatroid(3,5)
A = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
netList ADeterminant A


M = uniformMatroid(2,5)
A = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
netList (D = ADeterminant A)
-- Output:
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|       2                                2              2                   2                       2                                        2    2                                                     2                                                     2                 2 |
|w w w w  - w w w w w  - w w w w w  + w w w w  + w w w w  - w w w w w  + w w w w  - w w w w w  + w w w w  - w w w w w  - w w w w w  + w w w w  + w w w w   - w w w w w   - w w w w w   - w w w w w   + w w w w   - w w w w w   - w w w w w   - w w w w w   + w w w w   + w w w w  |
| 3 5 6 7    3 4 6 7 8    2 5 6 7 8    1 6 7 8    2 4 6 8    3 4 5 7 9    2 5 7 9    1 5 6 7 9    3 4 8 9    2 4 5 8 9    1 4 6 8 9    1 4 5 9    3 4 7 10    2 3 5 7 10    1 3 6 7 10    2 3 4 8 10    2 5 8 10    1 2 6 8 10    1 3 4 9 10    1 2 5 9 10    1 6 9 10    1 2 3 10|
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2 2                2 2                              2 2                                                                                                                                                                                                                         |
|w w  - 2w w w w  + w w  - 2w w w w   - 2w w w w   + w w                                                                                                                                                                                                                          |
| 6 8     5 6 8 9    5 9     3 6 8 10     3 5 9 10    3 10                                                                                                                                                                                                                        |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2 2                2 2                              2 2                                                                                                                                                                                                                         |
|w w  - 2w w w w  + w w  - 2w w w w   - 2w w w w   + w w                                                                                                                                                                                                                          |
| 6 7     4 6 7 9    4 9     2 6 7 10     2 4 9 10    2 10                                                                                                                                                                                                                        |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2 2                2 2                              2 2                                                                                                                                                                                                                         |
|w w  - 2w w w w  + w w  - 2w w w w   - 2w w w w   + w w                                                                                                                                                                                                                          |
| 5 7     4 5 7 8    4 8     1 5 7 10     1 4 8 10    1 10                                                                                                                                                                                                                        |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2 2                2 2                            2 2                                                                                                                                                                                                                           |
|w w  - 2w w w w  + w w  - 2w w w w  - 2w w w w  + w w                                                                                                                                                                                                                            |
| 3 7     2 3 7 8    2 8     1 3 7 9     1 2 8 9    1 9                                                                                                                                                                                                                           |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2 2                2 2                            2 2                                                                                                                                                                                                                           |
|w w  - 2w w w w  + w w  - 2w w w w  - 2w w w w  + w w                                                                                                                                                                                                                            |
| 3 4     2 3 4 5    2 5     1 3 4 6     1 2 5 6    1 6                                                                                                                                                                                                                           |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

-- deletions:
-- 3,5,6,8,9,10
-- 2,4,6,7,9,10
-- 1,4,5,7,8,10
-- 
toricMLDegree(A, {1,1,1, 1,1,1, 1,4,1,1})
toricMLDegree(A, {1,1,1, 1,1,1, 4,1,1,1})
toricMLDegree(A, {1,1,1, 1,1,2, 1,2,1,1})
toricMLDegree(A, {1,1,2, 1,1,1, 2,1,1,1})
toricMLDegree(A, {1,1,1, 1,4,1, 1,1,1,2})
toricMLDegree(A, {1,1,4, 1,1,1, 4,1,1,1})
toricMLDegree(A, {1,1,1, 4,1,1, 9,4,1,1})

w = {1, 1,1, 4,1,1, 9,4,1,1}
D / (f -> sub(f, for i from 0 to 9 list (ring f)_i => w_i))


M = uniformMatroid(2,6)
A = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
netList (D = ADeterminant(A, Strategy => "Variables"))
-- Output
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2 2              2     2 2 2               2               2     2 2  2      2                                                       2                                                                                                              2           2 2 2              2     2 2 2               2               2     2 2  2                            2           2                                                                                                                                    2                2                                               2                                                                                                                  2           2 2 2              2     2 2 2               2               2     2 2  2                            2                                                                                       2           2                                                          2                                                                                                         2                              2                                       2                                                                     2                                                                                     2               2 2 2              2     2 2 2              2              2     2 2 2                                                              2                                 2                               2                                                                                            2                                 2                                                                    2                                                       2                                 2                                                                                                         2                2                                                                     2                                                                     2                                 2 2 2              2     2 2 2              2              2     2 2 2 |
o102 = |w w w   - 2w w w w w   + w w w   - 2w w w w  w   - 2w w w w  w   + w w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 4w w w w  w  w   - 2w w w  w  w   + w w w   - 2w w w w w   + w w w   - 2w w w w  w   - 2w w w w  w   + w w  w   + 2w w w w w  w   - 2w w w w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 4w w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 2w w w  w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   - 4w w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 2w w w  w  w   + w w w   - 2w w w w w   + w w w   - 2w w w w  w   - 2w w w w  w   + w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w w  w   - 4w w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   - 2w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 4w w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w  w  w   - 2w w w  w  w   + 2w w w w  w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 4w w w w w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 2w w w  w  w   + w w w   - 2w w w w w   + w w w   - 2w w w w w   - 2w w w w w   + w w w   - 4w w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w w  w   - 2w w w  w  w   + 2w w w w  w  w   + 2w w w w  w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   - 4w w w w w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   + 2w w w w  w  w   - 2w w w  w  w   + 2w w w w  w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 4w w w w w  w   + 2w w w w  w  w   + 2w w w w  w  w   - 2w w w  w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   + 2w w w w w  w   + 2w w w w w  w   + 2w w w w w  w   - 2w w w w  w   - 4w w w w  w  w   + w w w   - 2w w w w w   + w w w   - 2w w w w w   - 2w w w w w   + w w w  |
       | 6 8 11     5 6 8 9 11    5 9 11     3 6 8 10 11     3 5 9 10 11    3 10 11     6 7 8 11 12     5 6 7 9 11 12     4 6 8 9 11 12     4 5 9 11 12     3 6 7 10 11 12     2 6 8 10 11 12     3 4 9 10 11 12     2 5 9 10 11 12     1 6 9 10 11 12     2 3 10 11 12    6 7 12     4 6 7 9 12    4 9 12     2 6 7 10 12     2 4 9 10 12    2 10 12     5 6 7 8 11 13     4 6 8 11 13     5 7 9 11 13     4 5 8 9 11 13     3 5 7 10 11 13     3 4 8 10 11 13     2 5 8 10 11 13     1 6 8 10 11 13     1 5 9 10 11 13     1 3 10 11 13     5 6 7 12 13     4 6 7 8 12 13     4 5 7 9 12 13     4 8 9 12 13     3 4 7 10 12 13     2 5 7 10 12 13     1 6 7 10 12 13     2 4 8 10 12 13     1 4 9 10 12 13     1 2 10 12 13    5 7 13     4 5 7 8 13    4 8 13     1 5 7 10 13     1 4 8 10 13    1 10 13     3 6 7 8 11 14     2 6 8 11 14     3 5 7 9 11 14     3 4 8 9 11 14     2 5 8 9 11 14     1 6 8 9 11 14     1 5 9 11 14     3 7 10 11 14     2 3 8 10 11 14     1 3 9 10 11 14     3 6 7 12 14     2 6 7 8 12 14     3 4 7 9 12 14     2 5 7 9 12 14     1 6 7 9 12 14     2 4 8 9 12 14     1 4 9 12 14     2 3 7 10 12 14     2 8 10 12 14     1 2 9 10 12 14     3 5 7 13 14     3 4 7 8 13 14     2 5 7 8 13 14     1 6 7 8 13 14     2 4 8 13 14     1 5 7 9 13 14     1 4 8 9 13 14     1 3 7 10 13 14     1 2 8 10 13 14     1 9 10 13 14    3 7 14     2 3 7 8 14    2 8 14     1 3 7 9 14     1 2 8 9 14    1 9 14     3 5 6 7 11 15     3 4 6 8 11 15     2 5 6 8 11 15     1 6 8 11 15     3 4 5 9 11 15     2 5 9 11 15     1 5 6 9 11 15     3 4 10 11 15     2 3 5 10 11 15     1 3 6 10 11 15     3 4 6 7 12 15     2 5 6 7 12 15     1 6 7 12 15     2 4 6 8 12 15     3 4 9 12 15     2 4 5 9 12 15     1 4 6 9 12 15     2 3 4 10 12 15     2 5 10 12 15     1 2 6 10 12 15     3 4 5 7 13 15     2 5 7 13 15     1 5 6 7 13 15     3 4 8 13 15     2 4 5 8 13 15     1 4 6 8 13 15     1 4 5 9 13 15     1 3 4 10 13 15     1 2 5 10 13 15     1 6 10 13 15     3 4 7 14 15     2 3 5 7 14 15     1 3 6 7 14 15     2 3 4 8 14 15     2 5 8 14 15     1 2 6 8 14 15     1 3 4 9 14 15     1 2 5 9 14 15     1 6 9 14 15     1 2 3 10 14 15    3 4 15     2 3 4 5 15    2 5 15     1 3 4 6 15     1 2 5 6 15    1 6 15|
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       |        2                                       2                  2                      2                            2                                               2     2                                                          2                                                          2                   2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
       |w w w  w   - w w w  w  w   - w w w  w  w   + w w  w  w   + w w w  w   - w w w w  w   + w w w  w   - w w w  w  w   + w w w  w   - w w w w  w   - w w w  w  w   + w w w w   + w w w  w   - w w w w  w   - w w w  w  w   - w w w w  w   + w w w  w   - w w w  w  w   - w w w w  w   - w w w w  w   + w w  w  w   + w w w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
       | 6 9 10 12    6 8 10 12 13    5 9 10 12 13    3 10 12 13    5 8 10 13    6 8 9 12 14    5 9 12 14    3 9 10 12 14    6 8 13 14    5 8 9 13 14    3 8 10 13 14    3 8 9 14    6 8 12 15    5 6 9 12 15    3 6 10 12 15    5 6 8 13 15    5 9 13 15    3 5 10 13 15    3 6 8 14 15    3 5 9 14 15    3 10 14 15    3 5 6 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       |        2                                       2                  2                      2                            2                                               2     2                                                          2                                                          2                   2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
       |w w w  w   - w w w  w  w   - w w w  w  w   + w w  w  w   + w w w  w   - w w w w  w   + w w w  w   - w w w  w  w   + w w w  w   - w w w w  w   - w w w  w  w   + w w w w   + w w w  w   - w w w w  w   - w w w  w  w   - w w w w  w   + w w w  w   - w w w  w  w   - w w w w  w   - w w w w  w   + w w  w  w   + w w w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
       | 6 9 10 11    6 7 10 11 13    4 9 10 11 13    2 10 11 13    4 7 10 13    6 7 9 11 14    4 9 11 14    2 9 10 11 14    6 7 13 14    4 7 9 13 14    2 7 10 13 14    2 7 9 14    6 7 11 15    4 6 9 11 15    2 6 10 11 15    4 6 7 13 15    4 9 13 15    2 4 10 13 15    2 6 7 14 15    2 4 9 14 15    2 10 14 15    2 4 6 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       |        2                                       2                  2                      2                            2                                               2     2                                                          2                                                          2                   2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
       |w w w  w   - w w w  w  w   - w w w  w  w   + w w  w  w   + w w w  w   - w w w w  w   + w w w  w   - w w w  w  w   + w w w  w   - w w w w  w   - w w w  w  w   + w w w w   + w w w  w   - w w w w  w   - w w w  w  w   - w w w w  w   + w w w  w   - w w w  w  w   - w w w w  w   - w w w w  w   + w w  w  w   + w w w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
       | 5 8 10 11    5 7 10 11 12    4 8 10 11 12    1 10 11 12    4 7 10 12    5 7 8 11 14    4 8 11 14    1 8 10 11 14    5 7 12 14    4 7 8 12 14    1 7 10 12 14    1 7 8 14    5 7 11 15    4 5 8 11 15    1 5 10 11 15    4 5 7 12 15    4 8 12 15    1 4 10 12 15    1 5 7 14 15    1 4 8 14 15    1 10 14 15    1 4 5 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       |       2                                     2                2                      2                           2                                              2     2                                                         2                                                         2                  2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w w w   - w w w w  w   - w w w w  w   + w w w  w   + w w w w   - w w w w  w   + w w w  w   - w w w w  w   + w w w  w   - w w w w  w   - w w w w  w   + w w w w   + w w w  w   - w w w w  w   - w w w w  w   - w w w w  w   + w w w  w   - w w w w  w   - w w w w  w   - w w w w  w   + w w w  w   + w w w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 3 8 9 11    3 7 9 11 12    2 8 9 11 12    1 9 11 12    2 7 9 12    3 7 8 11 13    2 8 11 13    1 8 9 11 13    3 7 12 13    2 7 8 12 13    1 7 9 12 13    1 7 8 13    3 7 11 15    2 3 8 11 15    1 3 9 11 15    2 3 7 12 15    2 8 12 15    1 2 9 12 15    1 3 7 13 15    1 2 8 13 15    1 9 13 15    1 2 3 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       |       2                                     2                2                      2                           2                                              2     2                                                         2                                                         2                  2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w w w   - w w w w  w   - w w w w  w   + w w w  w   + w w w w   - w w w w  w   + w w w  w   - w w w w  w   + w w w  w   - w w w w  w   - w w w w  w   + w w w w   + w w w  w   - w w w w  w   - w w w w  w   - w w w w  w   + w w w  w   - w w w w  w   - w w w w  w   - w w w w  w   + w w w  w   + w w w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 3 5 6 11    3 4 6 11 12    2 5 6 11 12    1 6 11 12    2 4 6 12    3 4 5 11 13    2 5 11 13    1 5 6 11 13    3 4 12 13    2 4 5 12 13    1 4 6 12 13    1 4 5 13    3 4 11 14    2 3 5 11 14    1 3 6 11 14    2 3 4 12 14    2 5 12 14    1 2 6 12 14    1 3 4 13 14    1 2 5 13 14    1 6 13 14    1 2 3 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       |       2                                2              2                   2                       2                                        2    2                                                     2                                                     2                 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
       |w w w w  - w w w w w  - w w w w w  + w w w w  + w w w w  - w w w w w  + w w w w  - w w w w w  + w w w w  - w w w w w  - w w w w w  + w w w w  + w w w w   - w w w w w   - w w w w w   - w w w w w   + w w w w   - w w w w w   - w w w w w   - w w w w w   + w w w w   + w w w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       | 3 5 6 7    3 4 6 7 8    2 5 6 7 8    1 6 7 8    2 4 6 8    3 4 5 7 9    2 5 7 9    1 5 6 7 9    3 4 8 9    2 4 5 8 9    1 4 6 8 9    1 4 5 9    3 4 7 10    2 3 5 7 10    1 3 6 7 10    2 3 4 8 10    2 5 8 10    1 2 6 8 10    1 3 4 9 10    1 2 5 9 10    1 6 9 10    1 2 3 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2  2                    2 2                                  2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
       |w  w   - 2w w  w  w   + w w   - 2w w  w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
       | 10 13     9 10 13 14    9 14     6 10 13 15     6 9 14 15    6 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2  2                    2 2                                  2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
       |w  w   - 2w w  w  w   + w w   - 2w w  w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
       | 10 12     8 10 12 14    8 14     5 10 12 15     5 8 14 15    5 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 9 12     8 9 12 13    8 13     3 9 12 15     3 8 13 15    3 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 6 12     5 6 12 13    5 13     3 6 12 14     3 5 13 14    3 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                2 2                              2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
       |w w  - 2w w w w  + w w  - 2w w w w   - 2w w w w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
       | 6 8     5 6 8 9    5 9     3 6 8 10     3 5 9 10    3 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2  2                    2 2                                  2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
       |w  w   - 2w w  w  w   + w w   - 2w w  w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
       | 10 11     7 10 11 14    7 14     4 10 11 15     4 7 14 15    4 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 9 11     7 9 11 13    7 13     2 9 11 15     2 7 13 15    2 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 6 11     4 6 11 13    4 13     2 6 11 14     2 4 13 14    2 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                2 2                              2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
       |w w  - 2w w w w  + w w  - 2w w w w   - 2w w w w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
       | 6 7     4 6 7 9    4 9     2 6 7 10     2 4 9 10    2 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 8 11     7 8 11 12    7 12     1 8 11 15     1 7 12 15    1 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 5 11     4 5 11 12    4 12     1 5 11 14     1 4 12 14    1 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                2 2                              2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
       |w w  - 2w w w w  + w w  - 2w w w w   - 2w w w w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
       | 5 7     4 5 7 8    4 8     1 5 7 10     1 4 8 10    1 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                   2 2                                 2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
       |w w   - 2w w w  w   + w w   - 2w w w  w   - 2w w w  w   + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
       | 3 11     2 3 11 12    2 12     1 3 11 13     1 2 12 13    1 13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                2 2                            2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
       |w w  - 2w w w w  + w w  - 2w w w w  - 2w w w w  + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
       | 3 7     2 3 7 8    2 8     1 3 7 9     1 2 8 9    1 9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
       | 2 2                2 2                            2 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
       |w w  - 2w w w w  + w w  - 2w w w w  - 2w w w w  + w w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
       | 3 4     2 3 4 5    2 5     1 3 4 6     1 2 5 6    1 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
       +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

toricMLDegree(A, {1, 1, 1,  4, 1, 1,  9, 4, 1, 1, 16, 9, 4, 1, 1})

w = {1, 1,1, 4,1,1, 9,4,1,1, 16,9,4,1,1}
D / (f -> sub(f, for i from 0 to 9 list (ring f)_i => w_i))


-- the A-discriminant of the entire polytope is:
QQ[w_1..w_15]
(w_6^2*w_8^2*w_11^2-2*w_5*w_6*w_8*w_9*w_11^2+w_5^2*w_9^2*w_11^2-2*w_3*w_6*w_8*w_10*w_11^2-2*w_3*w_5*w_9*w_10*w_11^2+w_3^2*w_10^2*w_11^2-2*w
      _6^2*w_7*w_8*w_11*w_12+2*w_5*w_6*w_7*w_9*w_11*w_12+2*w_4*w_6*w_8*w_9*w_11*w_12-2*w_4*w_5*w_9^2*w_11*w_12+2*w_3*w_6*w_7*w_10*w_11*w_12+2*w_
      2*w_6*w_8*w_10*w_11*w_12+2*w_3*w_4*w_9*w_10*w_11*w_12+2*w_2*w_5*w_9*w_10*w_11*w_12-4*w_1*w_6*w_9*w_10*w_11*w_12-2*w_2*w_3*w_10^2*w_11*w_12
      +w_6^2*w_7^2*w_12^2-2*w_4*w_6*w_7*w_9*w_12^2+w_4^2*w_9^2*w_12^2-2*w_2*w_6*w_7*w_10*w_12^2-2*w_2*w_4*w_9*w_10*w_12^2+w_2^2*w_10^2*w_12^2+2*
      w_5*w_6*w_7*w_8*w_11*w_13-2*w_4*w_6*w_8^2*w_11*w_13-2*w_5^2*w_7*w_9*w_11*w_13+2*w_4*w_5*w_8*w_9*w_11*w_13+2*w_3*w_5*w_7*w_10*w_11*w_13+2*w
      _3*w_4*w_8*w_10*w_11*w_13-4*w_2*w_5*w_8*w_10*w_11*w_13+2*w_1*w_6*w_8*w_10*w_11*w_13+2*w_1*w_5*w_9*w_10*w_11*w_13-2*w_1*w_3*w_10^2*w_11*w_
      13-2*w_5*w_6*w_7^2*w_12*w_13+2*w_4*w_6*w_7*w_8*w_12*w_13+2*w_4*w_5*w_7*w_9*w_12*w_13-2*w_4^2*w_8*w_9*w_12*w_13-4*w_3*w_4*w_7*w_10*w_12*w_
      13+2*w_2*w_5*w_7*w_10*w_12*w_13+2*w_1*w_6*w_7*w_10*w_12*w_13+2*w_2*w_4*w_8*w_10*w_12*w_13+2*w_1*w_4*w_9*w_10*w_12*w_13-2*w_1*w_2*w_10^2*w_
      12*w_13+w_5^2*w_7^2*w_13^2-2*w_4*w_5*w_7*w_8*w_13^2+w_4^2*w_8^2*w_13^2-2*w_1*w_5*w_7*w_10*w_13^2-2*w_1*w_4*w_8*w_10*w_13^2+w_1^2*w_10^2*w_
      13^2+2*w_3*w_6*w_7*w_8*w_11*w_14-2*w_2*w_6*w_8^2*w_11*w_14+2*w_3*w_5*w_7*w_9*w_11*w_14-4*w_3*w_4*w_8*w_9*w_11*w_14+2*w_2*w_5*w_8*w_9*w_11*
      w_14+2*w_1*w_6*w_8*w_9*w_11*w_14-2*w_1*w_5*w_9^2*w_11*w_14-2*w_3^2*w_7*w_10*w_11*w_14+2*w_2*w_3*w_8*w_10*w_11*w_14+2*w_1*w_3*w_9*w_10*w_11
      *w_14-2*w_3*w_6*w_7^2*w_12*w_14+2*w_2*w_6*w_7*w_8*w_12*w_14+2*w_3*w_4*w_7*w_9*w_12*w_14-4*w_2*w_5*w_7*w_9*w_12*w_14+2*w_1*w_6*w_7*w_9*w_12
      *w_14+2*w_2*w_4*w_8*w_9*w_12*w_14-2*w_1*w_4*w_9^2*w_12*w_14+2*w_2*w_3*w_7*w_10*w_12*w_14-2*w_2^2*w_8*w_10*w_12*w_14+2*w_1*w_2*w_9*w_10*w_
      12*w_14-2*w_3*w_5*w_7^2*w_13*w_14+2*w_3*w_4*w_7*w_8*w_13*w_14+2*w_2*w_5*w_7*w_8*w_13*w_14-4*w_1*w_6*w_7*w_8*w_13*w_14-2*w_2*w_4*w_8^2*w_13
      *w_14+2*w_1*w_5*w_7*w_9*w_13*w_14+2*w_1*w_4*w_8*w_9*w_13*w_14+2*w_1*w_3*w_7*w_10*w_13*w_14+2*w_1*w_2*w_8*w_10*w_13*w_14-2*w_1^2*w_9*w_10*w
      _13*w_14+w_3^2*w_7^2*w_14^2-2*w_2*w_3*w_7*w_8*w_14^2+w_2^2*w_8^2*w_14^2-2*w_1*w_3*w_7*w_9*w_14^2-2*w_1*w_2*w_8*w_9*w_14^2+w_1^2*w_9^2*w_14
      ^2-4*w_3*w_5*w_6*w_7*w_11*w_15+2*w_3*w_4*w_6*w_8*w_11*w_15+2*w_2*w_5*w_6*w_8*w_11*w_15-2*w_1*w_6^2*w_8*w_11*w_15+2*w_3*w_4*w_5*w_9*w_11*w_
      15-2*w_2*w_5^2*w_9*w_11*w_15+2*w_1*w_5*w_6*w_9*w_11*w_15-2*w_3^2*w_4*w_10*w_11*w_15+2*w_2*w_3*w_5*w_10*w_11*w_15+2*w_1*w_3*w_6*w_10*w_11*w
      _15+2*w_3*w_4*w_6*w_7*w_12*w_15+2*w_2*w_5*w_6*w_7*w_12*w_15-2*w_1*w_6^2*w_7*w_12*w_15-4*w_2*w_4*w_6*w_8*w_12*w_15-2*w_3*w_4^2*w_9*w_12*w_
      15+2*w_2*w_4*w_5*w_9*w_12*w_15+2*w_1*w_4*w_6*w_9*w_12*w_15+2*w_2*w_3*w_4*w_10*w_12*w_15-2*w_2^2*w_5*w_10*w_12*w_15+2*w_1*w_2*w_6*w_10*w_12
      *w_15+2*w_3*w_4*w_5*w_7*w_13*w_15-2*w_2*w_5^2*w_7*w_13*w_15+2*w_1*w_5*w_6*w_7*w_13*w_15-2*w_3*w_4^2*w_8*w_13*w_15+2*w_2*w_4*w_5*w_8*w_13*w
      _15+2*w_1*w_4*w_6*w_8*w_13*w_15-4*w_1*w_4*w_5*w_9*w_13*w_15+2*w_1*w_3*w_4*w_10*w_13*w_15+2*w_1*w_2*w_5*w_10*w_13*w_15-2*w_1^2*w_6*w_10*w_
      13*w_15-2*w_3^2*w_4*w_7*w_14*w_15+2*w_2*w_3*w_5*w_7*w_14*w_15+2*w_1*w_3*w_6*w_7*w_14*w_15+2*w_2*w_3*w_4*w_8*w_14*w_15-2*w_2^2*w_5*w_8*w_14
      *w_15+2*w_1*w_2*w_6*w_8*w_14*w_15+2*w_1*w_3*w_4*w_9*w_14*w_15+2*w_1*w_2*w_5*w_9*w_14*w_15-2*w_1^2*w_6*w_9*w_14*w_15-4*w_1*w_2*w_3*w_10*w_
      14*w_15+w_3^2*w_4^2*w_15^2-2*w_2*w_3*w_4*w_5*w_15^2+w_2^2*w_5^2*w_15^2-2*w_1*w_3*w_4*w_6*w_15^2-2*w_1*w_2*w_5*w_6*w_15^2+w_1^2*w_6^2*w_15^
      2)


M = uniformMatroid(2,7)
A = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
-- ADiscriminant A
-- ADeterminant A
w = {1,1,1, 4,1,1, 9,4,1,1, 16,9,4,1,1, 25,16,9,4,1,1}
toricMLDegree(A, w)

ADiscriminant A



M = uniformMatroid(2,8)
 = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
-- ADiscriminant A
-- ADeterminant A
w = {1,1,1, 4,1,1, 9,4,1,1, 16,9,4,1,1, 25,16,9,4,1,1, 36,25,16,9,4,1,1}
toricMLDegree(A, w)

M = uniformMatroid(2,9)
A = basisMatrix M
T = twistedToricIdeal(A, toList(# bases M : 1))
degree T
-- ADiscriminant A
-- ADeterminant A
w = {1,1,1, 4,1,1, 9,4,1,1, 16,9,4,1,1, 25,16,9,4,1,1, 36,25,16,9,4,1,1, 49,36,25,16,9,4,1,1}
toricMLDegree(A, w)


-----------
-- finding w's that satisfy all the deletion factors of Determinant
-- For U(2,5)
a = symbol a
u = symbol u
v = symbol v
R = QQ[a_1 .. a_10, u_1 .. u_5, v_1 .. v_5]

I = ideal (
    a_3*a_10 - u_1,
    a_5*a_9 - u_1*v_1^2,
    a_6*a_8 - u_1*(v_1 + 1)^2,
    a_2*a_10 - u_2,
    a_4*a_9 - u_2*v_2^2,
    a_6*a_7 - u_2*(v_2 + 1)^2,
    a_1*a_10 - u_3,
    a_4*a_8 - u_3*v_3^2,
    a_5*a_7 - u_3*(v_3 + 1)^2,
    a_1*a_9 - u_4,
    a_2*a_8 - u_4*v_4^2,
    a_3*a_7 - u_4*(v_4 + 1)^2,
    a_1*a_6 - u_5,
    a_2*a_5 - u_5*v_5^2,
    a_3*a_4 - u_5*(v_5 + 1)^2
    )

degree I
J = I + ideal(a_1 - 1, u_1 - 1, u_2 - 1, u_3 - 1, u_4 - 1, u_5 - 1, v_1 - 1)
Js = saturate(J, u_1*u_2*u_3*u_4*u_5)

dim (I + ideal(a_1 - 1, u_1 - 1, u_2 - 1, u_3 - 1, u_4 - 1, u_5 - 1, v_1 - 1))

solveSystem first entries mingens Js    

--------------------
-- U(2,4)

--R = QQ[u_1 .. u_6, v_1 .. v_6, q, t_1 .. t_6, s_1 .. s_6, w_1 .. w_6, MonomialOrder => Eliminate(13)]
R = QQ[u_1 .. u_6, q, t_1 .. t_4, w_1 .. w_6, MonomialOrder => Eliminate(7)]

M = matroid matrix {
    {1,1,1,1},
    {1,2,3,4}
    }
bases M
A = basisMatrix M

g = sum for i from 1 to 6 list w_i * product for j from 1 to 4 list t_j^(A_(j-1,i-1))

    
I = ideal (
    u_1 + u_2 + u_4 - q*t_1*diff(t_1, g),
    u_1 + u_3 + u_5 - q*t_2*diff(t_2, g),
    u_2 + u_3 + u_6 - q*t_3*diff(t_3, g),
    u_4 + u_5 + u_6 - q*t_4*diff(t_4, g),
    g - 1
    )    
dim I
degree I

M = matrix {
    {u_1 + u_2 + u_4, t_1*diff(t_1, g)},
    {u_1 + u_3 + u_5, t_2*diff(t_2, g)},
    {u_2 + u_3 + u_6, t_3*diff(t_3, g)},
    {u_4 + u_5 + u_6, t_4*diff(t_4, g)}
    }
-- + ideal(for i from 1 to 6 list u_i*v_i - 1)
-- I = minors(2, M) + ideal(g -1) + ideal(for i from 1 to 6 list u_i*v_i - 1) + ideal(for i from 1 to 6 list t_i*s_i - 1)
I = minors(2, M) + ideal(g -1, q-1)
dim I
degree I
first entries selectInSubring(1, gens gb I)

Iu = I + ideal(for i from 1 to 6 list u_i - 1)
Iwu = Iu + ideal(for i from 1 to 6 list w_i - 1)
dim Iwu
degree Iwu
netList solveSystem first entries mingens Iwu

J = MLParamIdeal(A, {1,1,1,1,1,1}, {1,1,1,1,1,1})
dim J	 
degree J

transpose mingens J
transpose mingens Iwu

tt = torusMap(A, {1,1,1,1,1,1})
netList tt solveSystem first entries gens J 
--------------

M = matroid matrix {
    {1,1,1,1},
    {1,2,3,4}
    }
bases M
A = basisMatrix M
w = {1,1,1,4,1,1}
toricMLDegree(A, w)

P = convexHull A
C = cone P
isSmooth C
------

-- W matrix experiments

WMat = n -> (
    if n == 1 then matrix {{0}} else (
	M' := WMat(n-1);
	newRow := matrix {for i from 0 to n-2 list 
	)
    )

-- algebraic relations among principal minors

R = QQ[x_(1,1) .. x_(5,5)]
X = transpose genericMatrix(R, 5, 5)
X' = matrix for i from 0 to 4 list for j from 0 to 4 list if i < j then X_(i,j) else 0
Y = X' + transpose X'
S = QQ[y_0, y_1 .. y_5]
l = toList(0 .. 4)
m = map(R, S, {det Y} | for i from 0 to 4 list (l' := delete(i, l); det Y^(l')_(l')))
m' = map(R, S, {0} | for i from 0 to 4 list (l' := delete(i, l); det Y^(l')_(l')))
I = ker m
I' = ker m'

-- Tobias' matrix:
needs "matroids.m2"
A = basisMatrix uniformMatroid(2, 5)
toricMLDegree(A, {1,1,1, 1,1,1, 1,4,1,1}) -- 8
--{w12 -> -27, w13 -> -10, w14 -> -64, w15 -> -51, w23 -> 25, w24 -> 90, w25 -> 2295/32, w34 -> 100/27, w35 -> 20825/144, w45 -> 680}
w = {-27, -10,25, -64,90,100/27, -51,2295/32,20825/144,680}  -- 6
toricMLDegree(A, w)

w = {-28, -10,25, -64,90,100/27, -51,2295/32,20825/144,680}  -- 9
toricMLDegree(A, w)

w = {1,1,1,1,1,1,1,1,1,1} -- 11
toricMLDegree(A, w)


D = ADeterminant A
I = ideal D
isPrime I

----------------------
needs "matroids.m2"
A = basisMatrix uniformMatroid(2, 6)
toricMLDegree(A, {1,1,1, 1,1,1, 9,4,1,1, })
--{w12 -> -27, w13 -> -10, w14 -> -64, w15 -> -51, w23 -> 25, w24 -> 90, w25 -> 2295/32, w34 -> 100/27, w35 -> 20825/144, w45 -> 680}
w = {-27, -10,25, -64,90,100/27, -51,2295/32,20825/144,680, 1,1,1,1,1}  
toricMLDegree(A, w)

D = ADeterminant A
I = ideal D
isPrime I


---------------------




---------------------
x = symbol x
n = 5
R = QQ[flatten for i from 1 to n-1 list for j from i+1 to n list x_(i, j)] 
vars R
M = matrix for i from 1 to n list for j from 1 to n list if i < j then x_(i,j) else if j < i then x_(j,i) else 0
I = ideal for s in subsets(n, 4) list det M^s_s

J = radical I;
K = saturate(J, product gens R);
J == K

f = det M_{0 .. 4}^{0 .. 4}
L = decompose J

I' = L_1
isPrime I'



I' = I + ideal(f)
-- I' subset of L_0
isSubset(L_0, I')
rI' = radical I';
isSubset(L_0, rI')
L_0 == rI'

dim I
